image: hpcer/hpcdev:pkg-0.2.0
#services:
#  - postgres

cache:
  key: "$CI_COMMIT_REF_SLUG"
  paths:
  - vendor/

stages:
  - fetch
  - build
#  - test
#  - deploy

fetch:
  stage: fetch
  tags:
    - cpp
    - pkg
  script:
    - pkg fetch
    - pkg install
  artifacts:
    untracked: true

build:
  stage: build
  tags:
    - cpp
    - pkg
  script:
    - cmake -Bcmake-build -DCMAKE_BUILD_TYPE=Debug -H.
    - make -Ccmake-build
#  artifacts:
#    untracked: true
  dependencies:
    - fetch
